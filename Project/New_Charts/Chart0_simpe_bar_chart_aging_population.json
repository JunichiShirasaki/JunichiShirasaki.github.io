{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "title": {
    "text": "OECD Countries Differ Widely in Population Ageing",
    "subtitle": [
      "Population aged 65 and above (% of total population), average 2015 - 2019.",
      "This highlights structural demographic differences before moving to multi-dimensional comparisons."
    ]
  },
  "data": {
    "url": "https://raw.githubusercontent.com/JunichiShirasaki/JunichiShirasaki.github.io/refs/heads/main/Project/New_base_data/analysis_capitalism_model_2015_2019.csv",
    "format": {"type": "csv"}
  },
  "transform": [
    {"calculate": "toNumber(datum.pop_65)", "as": "pop65_num"},
    {"filter": "isValid(datum.pop65_num)"},
    {"calculate": "format(datum.pop65_num, '.1f')", "as": "pop65_label"}
  ],
  "width": 620,
  "height": {"step": 10},
  "layer": [
    {
      "mark": {"type": "bar", "color": "#5688e4"},
      "encoding": {
        "y": {
          "field": "country_name",
          "type": "nominal",
          "title": null,
          "sort": {"field": "pop65_num", "order": "descending"}
        },
        "x": {
          "field": "pop65_num",
          "type": "quantitative",
          "title": "Population aged 65+ (% of total) â€” average 2015 - 2019",
          "axis": {"format": ".0f"}
        },
        "tooltip": [
          {"field": "country_name", "type": "nominal", "title": "Country"},
          {
            "field": "pop65_num",
            "type": "quantitative",
            "title": "Population 65+ (%)",
            "format": ".1f"
          }
        ]
      }
    },
    {
      "mark": {
        "type": "text",
        "align": "left",
        "baseline": "middle",
        "dx": 4,
        "fontSize": 10
      },
      "encoding": {
        "y": {
          "field": "country_name",
          "type": "nominal",
          "sort": {"field": "pop65_num", "order": "descending"}
        },
        "x": {"field": "pop65_num", "type": "quantitative"},
        "text": {"field": "pop65_label", "type": "nominal"}
      }
    }
  ],
  "config": {
    "axis": {"labelFontSize": 10, "titleFontSize": 12},
    "title": {"fontSize": 16, "subtitleFontSize": 12},
    "view": {"stroke": null}
  }
}